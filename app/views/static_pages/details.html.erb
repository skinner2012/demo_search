<!DOCTYPE html>
<html>
<head>
  <title><%= full_title(yield(:title)) %></title>
  <%= stylesheet_link_tag    "application", media: "all" %>
  <%= javascript_include_tag "jquery-1.9.1.js" %>
  <script type="text/javascript">
    $(document).ready(function(){
      doYQL("http://genemania.org/search/human/<%= @genes_for_yql %>");
      function doYQL(site) {
        var yql = 'http://query.yahooapis.com/v1/public/yql?q=' + encodeURIComponent('select * from html where url="' + site + '"');
        $.ajax({
          url: yql,
          type: "GET",
          dataType: "html",
          success: function(xml) {
            info = $(xml).find('results').html();
            // console.log(info);
            // $('#loadingImag').remove();
            // $('#network_visualization').html(info);
          },
          error: function(xhr, ajaxOptions, thrownError) {
            // alert(thrownError);
          }
        });
      }
    });
  </script>
  <style>
    html, body { height: 100%; width: 100%; padding: 0; margin: 0; }
    #details_list { width: 20%; height: 100%; float: left; }
    #network_visualization { width: 80%; height: 100%; float: right; }
  </style>
  <%= csrf_meta_tags %>
  <%= render 'layouts/shim' %>
</head>
  <body>
    <div id="details_list" style="overflow-x:hidden; overflow-y:scroll;">
      <div class="navbar navbar-inverse">
        <div class="navbar-inner">
          <ul class="nav pull-right">
            <li><%= link_to "Home", root_path %></li>
            <li><%= link_to "Help", help_path %></li>
          </ul>
        </div>
      </div>
      <div style="padding:0 10px"><dl>
        <dt>Term</dt><dd><%= @term_name %></dd> 
        <dt>Term id</dt><dd><%= @term_id %></dd>
        <dt>Ontology</dt><dd><%= @ontology_name %></dd>
        <dt>Ontology id</dt><dd><%= @ontology_id %></dd>
        <dt>Bioportal</dt><dd><%= link_to "Click Here", @bioportal_url, :target => '_blank' %></dd>
        <% if @auc.nil? %>
          <dt>AUC</dt><dd>N/A</dd>
        <% else %>
          <dt>AUC</dt><dd><%= @auc %></dd>
        <% end %>
        <dt>Number of Genes</dt><dd><%= @num_of_genes %></dd>
        <br>
        <table class="table table-condensed">
          <tr><td><strong>Gene Name</strong></td><td><strong>Gene ID</strong></td></tr>
            <% @gene_list.each do |gene| %>
              <tr><td><%= gene[1] %></td><td><%= gene[0] %></td></tr>
            <% end %> 
        </table>
      </dl></div>
    </div>
    <div id="network_visualization" style="overflow-x:hidden; overflow-y:hidden;">
      <% if @num_of_genes <= 100 %>
        <iframe src="http://genemania.org/search/human/<%= @genes %>&m=automatic&r=0" width="100%" height="100%"></iframe>
      <% else %>
        <br><br><br><br><br>
        <div class="container">
          <div class="alert alert-error">
            <p class="lead text-center">Won't display the network visualization because the number of genes exceeds 100.</p>
          </div>
        </div>
      <% end %>
    </div>
  </body>
</html>
