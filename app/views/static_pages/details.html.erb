<!DOCTYPE html>
<html>
<head>
  <title><%= full_title(yield(:title)) %></title>
  <%= stylesheet_link_tag    "application", media: "all" %>
  <%= javascript_include_tag "jquery-1.9.1.js" %>
  <script type="text/javascript">
    $(document).ready(function(){
      doYQL("http://genemania.org/search/human/<%= @genes_for_yql %>");
      function doYQL(site) {
        var yql = 'http://query.yahooapis.com/v1/public/yql?q=' + encodeURIComponent('select * from html where url="' + site + '"');
        $.ajax({
          url: yql,
          type: "GET",
          dataType: "html",
          success: function(xml) {
            info = $(xml).find('results').html();
            // console.log(info);
            // $('#loadingImag').remove();
            // $('#network_visualization').html(info);
          },
          error: function(xhr, ajaxOptions, thrownError) {
            // alert(thrownError);
          }
        });
      }
    });
  </script>
  <style>
    html, body { height: 100%; width: 100%; padding: 0; margin: 0; }
    #details_list { width: 100%; height: 25%; }
    #network_visualization { width: 100%; height: 75%; }
  </style>
  <%= csrf_meta_tags %>
  <%= render 'layouts/shim' %>
</head>
  <body>
    <div id="details_list">
      <%= render 'layouts/header' %>
      <br><br>
      <div class="container-fluid">
        <div class="row-fluid">
          <div class="span6">
            <dl class="dl-horizontal">
              <dt>Term</dt><dd><%= @term_name %></dd> 
              <dt>Term id</dt><dd><%= @term_id %></dd>
              <dt>Ontology</dt><dd><%= @ontology_name %></dd>
              <dt>Ontology id</dt><dd><%= @ontology_id %></dd>
              <dt>Bioportal</dt><dd><%= link_to @bioportal_url, @bioportal_url, :target => '_blank' %></dd>
              <% if @auc.nil? %>
                <dt>AUC</dt><dd>N/A</dd>
              <% else %>
                <dt>AUC</dt><dd><%= @auc %></dd>
              <% end %>
            </dl>
          </div>
          <div class="span6">
            <dl class="dl-horizontal">
              <dt>Number of Genes</dt><dd><%= @num_of_genes %></dd>
              <dt>List of Genes</dt>
              <dd>
                <select multiple="multiple">
                  <% @gene_list.each do |gene| %>
                    <option><%= gene[1] %> (<%= gene[0] %>)</option>
                  <% end %> 
                </select>
              </dd>
            </dl>
          </div>
        </div>
      </div>
    </div>
    <div id="network_visualization">
      <% if @num_of_genes <= 100 %>
        <iframe src="http://genemania.org/search/human/<%= @genes %>&m=automatic&r=0" width="100%" height="100%"></iframe>
      <% else %>
        <br><br><br><br><br>
        <div class="container">
          <div class="alert alert-error">
            <p class="lead text-center">Won't display the network visualization because the number of genes exceeds 100.</p>
          </div>
        </div>
      <% end %>
    </div>
  </body>
</html>
