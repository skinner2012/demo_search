<script type="text/javascript">
  window.onload=function() {
    var div_id = "cytoscape_web";

    var network_json = {

      dataSchema: {
        nodes: [ { name: "label", type: "string" } ],
        edges: [ { name: "label", type: "string" }, { name: "edge_color", type: "string" } ]
      },

      data: {
        nodes: [
          <% @gene_list.each do |gene| %>
            { id: "<%= gene[0] %>", 
              label: "<%= gene[1] %>" },
          <% end %>
        ],
        edges: [
          <% @get_networks.each do |single_network| %>
            { id: "<%= single_network[0] %>_<%= single_network[1] %>", 
              target: "<%= single_network[0] %>", 
              source: "<%= single_network[1] %>", 
              label: "<%= single_network[0] %> to <%= single_network[1] %>",
              <% if single_network[3] == "Co-expression" %>
                edge_color: "1",
              <% elsif single_network[3] == "Co-localization" %>
                edge_color: "2",
              <% elsif single_network[3] == "Pathway" %>
                edge_color: "3",
              <% elsif single_network[3] == "Physical interactions" %>
                edge_color: "4",
              <% end %>
              },
          <% end %>
        ]
      }

    };

    var options = {
      swfPath: "<%= asset_path("swf/CytoscapeWeb") %>",
      flashInstallerPath: "<%= asset_path("swf/playerProductInstall") %>"
    };

    var visual_style = {
      nodeTooltipsEnabled: true,
      edgeTooltipsEnabled: true,
      global: {
      },
      nodes: {
        size: 30,
        color: "#a8a8a8",
        borderColor: "#a8a8a8",
        labelFontName: "Arial Black", 
        labelFontSize: "14",
        labelFontColor: "#000000",
        labelFontWeight: "bold",
        tooltipText: "HELLO EDGES"
      },
      edges: {
        width: 3,
        color: {
          discreteMapper: {
            attrName: "edge_color",
            entries: [
              { attrValue: 1, value: "#8871AD" },
              { attrValue: 2, value: "#56AAFF" },
              { attrValue: 3, value: "#5F8730" },
              { attrValue: 4, value: "#DDAE1C" }
            ]
          }
        },
        tooltipText: "HELLO EDGES"
      }
    };

    var vis = new org.cytoscapeweb.Visualization(div_id, options);

    vis.ready(function() {
      vis.visualStyle(visual_style);
    });

    var draw_options = {
      network: network_json,
      layout: "CompoundSpringEmbedder",
    };

    vis.draw(draw_options);
  }
</script>
